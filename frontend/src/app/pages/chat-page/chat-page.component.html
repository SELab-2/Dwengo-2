<div class="chat-page">
    <app-authenticated-header></app-authenticated-header>
  
    <div class="content">
        <div class="sidebar">
            <button mat-stroked-button 
                    class="toggle-button"
                    (click)="toggleChatVisibility()">
                {{ showPublicChats ? USER_CHATS : OTHER_CHATS }}
            </button>
            
            <mat-nav-list>
                @for (thread of questionThreads; track thread.id) {
                    <a mat-list-item 
                       [routerLink]="['/', userType, 'chat', thread.id]"
                       [class.active]="thread.id === chatId">
                        <span class="visibility-badge" 
                            [class.private]="thread.visibility === VisibilityType.PRIVATE"
                            [class.group]="thread.visibility === VisibilityType.GROUP"
                            [class.public]="thread.visibility === VisibilityType.PUBLIC">
                            {{ thread.visibility === VisibilityType.PRIVATE ? 'üí¨' : (thread.visibility === VisibilityType.GROUP ? 'üë•' : 'üåê') }}
                        </span>
                        {{ thread.name?.slice(0, 50) || UNNAMED_CHAT }}
                    </a>
                }
            </mat-nav-list>
        </div>
    
        <div class="chatbox">
            @if (!validChatId) {
                <div class="invalid-chat-message">{{ INVALID_CHAT_ID }}</div>
            } @else {
                <app-chat [questionThreadId]="chatId" />
            }
        </div>
    </div>
</div>